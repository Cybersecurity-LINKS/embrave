<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="702px" preserveAspectRatio="none" style="width:1282px;height:702px;background:#FFFFFF;" version="1.1" viewBox="0 0 1282 702" width="1282px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="690.8438" style="stroke:#181818;stroke-width:0.5;" width="256.5" x="256" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="352.25" y="18.0669">Platform</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="282" x2="282" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="473.5" x2="473.5" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="826" x2="826" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1245.5" x2="1245.5" y1="72.7266" y2="646.25"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="260" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="267" y="61.4248">TPM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="260" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="267" y="665.2451">TPM</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="439.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="446.5" y="45.1279">Attester</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="453.5" y="61.4248">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="439.5" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="446.5" y="665.2451">Attester</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="453.5" y="681.542">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="794" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="814" y="45.1279">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="801" y="61.4248">Service</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="794" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="814" y="665.2451">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="801" y="681.542">Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="1215.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1222.5" y="61.4248">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="1215.5" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1222.5" y="665.2451">Verifier</text><polygon fill="#181818" points="293,99.8594,283,103.8594,293,107.8594,289,103.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="473" y1="103.8594" y2="103.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="98.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="312" y="98.7935">tpm2_createak</text><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="282" y1="132.9922" y2="132.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="240" y1="132.9922" y2="145.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="281" y1="145.9922" y2="145.9922"/><polygon fill="#181818" points="273,141.9922,283,145.9922,273,149.9922,277,145.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="188" y="127.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="201" y="127.9263">Generate AK</text><polygon fill="#181818" points="293,171.125,283,175.125,293,179.125,289,175.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="473" y1="175.125" y2="175.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="170.0591">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="312" y="170.0591">request EK_cert</text><polygon fill="#181818" points="462,200.2578,472,204.2578,462,208.2578,466,204.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="282" x2="468" y1="204.2578" y2="204.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="289" y="199.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="302" y="199.1919">EK_cert</text><polygon fill="#181818" points="814,239.957,824,243.957,814,247.957,818,243.957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="474" x2="820" y1="243.957" y2="243.957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="481" y="238.8911">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="494" y="238.8911">POST /api/request_join: AK pub, AK name, EK cert</text><path d="M831,217.2578 L831,257.2578 L1118,257.2578 L1118,227.2578 L1108,217.2578 L831,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1108,217.2578 L1108,227.2578 L1118,227.2578 L1108,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="837" y="234.3247">The attester notifies its presence.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="837" y="249.4575">The join server responds with a challenge.</text><line style="stroke:#181818;stroke-width:1.0;" x1="826" x2="868" y1="287.7227" y2="287.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="868" x2="868" y1="287.7227" y2="300.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="827" x2="868" y1="300.7227" y2="300.7227"/><polygon fill="#181818" points="837,296.7227,827,300.7227,837,304.7227,833,300.7227" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="833" y="282.6567">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="846" y="282.6567">validate EK_cert</text><path d="M960,267.5234 L960,307.5234 L1202,307.5234 L1202,277.5234 L1192,267.5234 L960,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1192,267.5234 L1192,277.5234 L1202,277.5234 L1192,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="966" y="284.5903">TPM is authentic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="966" y="299.7231">(validation of the EK certificate OK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="826" x2="868" y1="333.9219" y2="333.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="868" x2="868" y1="333.9219" y2="346.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="827" x2="868" y1="346.9219" y2="346.9219"/><polygon fill="#181818" points="837,342.9219,827,346.9219,837,350.9219,833,346.9219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="833" y="328.856">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="846" y="328.856">challenge = tpm2_makecredential(EK_pub, nonce, AK_name)</text><polygon fill="#181818" points="485,372.0547,475,376.0547,485,380.0547,481,376.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="479" x2="825" y1="376.0547" y2="376.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="491" y="370.9888">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="504" y="370.9888">challenge</text><polygon fill="#181818" points="293,426.8867,283,430.8867,293,434.8867,289,430.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="473" y1="430.8867" y2="430.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="425.8208">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="312" y="425.8208">tpm2_activatecredential</text><path d="M39,389.0547 L39,459.0547 L277,459.0547 L277,399.0547 L267,389.0547 L39,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M267,389.0547 L267,399.0547 L277,399.0547 L267,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="45" y="406.1216">tpm_activate credential verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="45" y="421.2544">the possession of AK_priv, EK_priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="45" y="436.3872">and verifies that they are in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="45" y="451.52">same TPM</text><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="282" y1="485.7188" y2="485.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="240" y1="485.7188" y2="498.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="281" y1="498.7188" y2="498.7188"/><polygon fill="#181818" points="273,494.7188,283,498.7188,273,502.7188,277,498.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="14" y="480.6528">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="36" y="480.6528">activate_credential(EK_priv, challenge)</text><polygon fill="#181818" points="462,523.8516,472,527.8516,462,531.8516,466,527.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="282" x2="468" y1="527.8516" y2="527.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="289" y="522.7856">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="311" y="522.7856">nonce</text><polygon fill="#181818" points="814,552.9844,824,556.9844,814,560.9844,818,556.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="474" x2="820" y1="556.9844" y2="556.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="481" y="551.9185">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="503" y="551.9185">POST /api/confirm_credential: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="826" x2="868" y1="586.1172" y2="586.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="868" x2="868" y1="586.1172" y2="599.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="827" x2="868" y1="599.1172" y2="599.1172"/><polygon fill="#181818" points="837,595.1172,827,599.1172,837,603.1172,833,599.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="833" y="581.0513">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="855" y="581.0513">Update Attester credential in the DB</text><polygon fill="#181818" points="1234,624.25,1244,628.25,1234,632.25,1238,628.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="826" x2="1240" y1="628.25" y2="628.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="833" y="623.1841">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="855" y="623.1841">notify a Verifier to start RA on the new Attester</text><!--SRC=[VLHTRnen47pthrZnGYA5HkeZ2f6eMbKghK0bxLEaq-9RmCsTVRKNqlpxhctku404YQ_rxEpExFg6RBWYDPmoKs3oyCqP2urtxBIhr91i2Hc2EtPsLw_8AxLo_s2mg93NpjS3rQ1deqs3bk5fyQFtVz0oFzlfXYmF00FW8LPW32af8epzjDZ7irsItnjDAUcFH8gG0qeD9nFuFfs1zeHid8N9H4djXr6VUmpSr1-BX29yoH3v6CDNikGb2DDPPbkorE_hlqhgwUzE0l1bLcZo746ZntDGUzYFZnvFXOnXCLy-mJqsvlv0MiJpiRG5pMvr5xyjrdGdT93eh9EclTbifUoMEYz1ucPjA83X80eeaDNq8M4Y8yIA0fE3njaomAlXBI3eBLOLsOr0ux0Zk_W1MB6yFPLlAPjAYVL6SAbtFXCCLI7NK-VmlkmzLgQCzhSk0Pm80tc9fs1aLtQy5NgZK_3ca1SdxjOWHwqlebr7lldiLf2TbFUxwCJ392zAZIyaorB6YbZTI7Df2DQ9bt4MHPn5BD0N_p2wmgkIZYjRYPhDNde-5cnTg6YTJH1S1uCZ3cIIQTWP92uqBWGAuU2BDDfuiuzBatua68edRPxa8CV4Dq1F8EiXlnCgYC1qYtic7kzDsqrnPbCgr-c-pJcNIvASlF3l-gNGpgwDhq-g7JdUc-ol9crNzrmxyIwBXS-VBYX-PtVyE5ycyGRQ4B23a9uGFwVWCeEbrwv0N7rR_WS0]--></g></svg>