<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="702px" preserveAspectRatio="none" style="width:1343px;height:702px;background:#FFFFFF;" version="1.1" viewBox="0 0 1343 702" width="1343px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="690.8438" style="stroke:#181818;stroke-width:0.5;" width="270.1787" x="264.5112" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.6763" x="354.2625" y="18.0669">IoT Platform</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289.5112" x2="289.5112" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="489.4331" x2="489.4331" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="876.5142" x2="876.5142" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1304.8301" x2="1304.8301" y1="72.7266" y2="646.25"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="268.5112" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="275.5112" y="61.4248">TPM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="268.5112" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="275.5112" y="665.2451">TPM</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.2568" x="448.4331" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.2568" x="455.4331" y="45.1279">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="468.8418" y="61.4248">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.2568" x="448.4331" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.2568" x="455.4331" y="665.2451">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="468.8418" y="681.542">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="844.5142" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.457" x="864.6563" y="45.1279">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="851.5142" y="61.4248">Service</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="844.5142" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.457" x="864.6563" y="665.2451">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="851.5142" y="681.542">Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0234" x="1272.8301" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0234" x="1279.8301" y="61.4248">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0234" x="1272.8301" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0234" x="1279.8301" y="665.2451">Verifier</text><polygon fill="#181818" points="301.0479,99.8594,291.0479,103.8594,301.0479,107.8594,297.0479,103.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="295.0479" x2="488.5615" y1="103.8594" y2="103.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.0479" y="98.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.4385" x="320.0933" y="98.7935">Request for AK creation</text><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="289.0479" y1="132.9922" y2="132.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="248.0479" y1="132.9922" y2="145.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="288.0479" y1="145.9922" y2="145.9922"/><polygon fill="#181818" points="278.0479,141.9922,288.0479,145.9922,278.0479,149.9922,282.0479,145.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="187.7368" y="127.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2656" x="200.7822" y="127.9263">Generate AK</text><polygon fill="#181818" points="301.0479,171.125,291.0479,175.125,301.0479,179.125,297.0479,175.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="295.0479" x2="488.5615" y1="175.125" y2="175.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.0479" y="170.0591">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.3486" x="320.0933" y="170.0591">Request EK_cert</text><polygon fill="#181818" points="477.5615,200.2578,487.5615,204.2578,477.5615,208.2578,481.5615,204.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="290.0479" x2="483.5615" y1="204.2578" y2="204.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="297.0479" y="199.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.8262" x="310.0933" y="199.1919">EK_cert</text><polygon fill="#181818" points="865.3848,247.5234,875.3848,251.5234,865.3848,255.5234,869.3848,251.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="489.5615" x2="871.3848" y1="251.5234" y2="251.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="496.5615" y="238.8911">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322.8164" x="509.6069" y="231.3247">POST /api/request_join: AK pub, AK name, EK cert</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.7495" x="666.6353" y="246.4575">IP address, port, Whitelist URI</text><path d="M882,217.2578 L882,257.2578 L1178,257.2578 L1178,227.2578 L1168,217.2578 L882,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1168,217.2578 L1168,227.2578 L1178,227.2578 L1168,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.3052" x="888" y="234.3247">The attester notifies its presence.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.8691" x="888" y="249.4575">The join server responds with a challenge.</text><line style="stroke:#181818;stroke-width:1.0;" x1="877.3848" x2="919.3848" y1="287.7227" y2="287.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="919.3848" x2="919.3848" y1="287.7227" y2="300.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="878.3848" x2="919.3848" y1="300.7227" y2="300.7227"/><polygon fill="#181818" points="888.3848,296.7227,878.3848,300.7227,888.3848,304.7227,884.3848,300.7227" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="884.3848" y="282.6567">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.355" x="897.4302" y="282.6567">Validate EK_cert</text><path d="M1015.4004,267.5234 L1015.4004,307.5234 L1265.4004,307.5234 L1265.4004,277.5234 L1255.4004,267.5234 L1015.4004,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1255.4004,267.5234 L1255.4004,277.5234 L1265.4004,277.5234 L1255.4004,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.2817" x="1021.4004" y="284.5903">TPM is authentic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.7661" x="1021.4004" y="299.7231">(validation of the EK certificate OK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="877.3848" x2="919.3848" y1="333.9219" y2="333.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="919.3848" x2="919.3848" y1="333.9219" y2="346.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="878.3848" x2="919.3848" y1="346.9219" y2="346.9219"/><polygon fill="#181818" points="888.3848,342.9219,878.3848,346.9219,888.3848,350.9219,884.3848,346.9219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="884.3848" y="328.856">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.9116" x="897.4302" y="328.856">challenge = TPM2_MakeCredential(EK_pub, nonce, AK_name)</text><polygon fill="#181818" points="500.5615,372.0547,490.5615,376.0547,500.5615,380.0547,496.5615,376.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="494.5615" x2="876.3848" y1="376.0547" y2="376.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="506.5615" y="370.9888">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.064" x="519.6069" y="370.9888">challenge</text><polygon fill="#181818" points="301.0479,426.8867,291.0479,430.8867,301.0479,434.8867,297.0479,430.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="295.0479" x2="488.5615" y1="430.8867" y2="430.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.0479" y="425.8208">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.4683" x="320.0933" y="425.8208">TPM2_ActivateCredential</text><path d="M41,389.0547 L41,459.0547 L284,459.0547 L284,399.0547 L274,389.0547 L41,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274,389.0547 L274,399.0547 L284,399.0547 L274,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.208" x="47" y="406.1216">TPM2_ActivateCredential verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.5869" x="47" y="421.2544">the possession of AK_priv, EK_priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.7813" x="47" y="436.3872">and verifies that they are in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.5298" x="47" y="451.52">same TPM</text><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="289.0479" y1="485.7188" y2="485.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="248.0479" y1="485.7188" y2="498.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.0479" x2="288.0479" y1="498.7188" y2="498.7188"/><polygon fill="#181818" points="278.0479,494.7188,288.0479,498.7188,278.0479,502.7188,282.0479,498.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="7" y="480.6528">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.957" x="29.0908" y="480.6528">activate_credential(EK_priv, challenge)</text><polygon fill="#181818" points="477.5615,523.8516,487.5615,527.8516,477.5615,531.8516,481.5615,527.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="290.0479" x2="483.5615" y1="527.8516" y2="527.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="297.0479" y="522.7856">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.5776" x="319.1387" y="522.7856">nonce</text><polygon fill="#181818" points="865.3848,552.9844,875.3848,556.9844,865.3848,560.9844,869.3848,556.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="489.5615" x2="871.3848" y1="556.9844" y2="556.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="496.5615" y="551.9185">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.3804" x="518.6523" y="551.9185">POST /api/confirm_credential: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="877.3848" x2="919.3848" y1="586.1172" y2="586.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="919.3848" x2="919.3848" y1="586.1172" y2="599.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="878.3848" x2="919.3848" y1="599.1172" y2="599.1172"/><polygon fill="#181818" points="888.3848,595.1172,878.3848,599.1172,888.3848,603.1172,884.3848,599.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="884.3848" y="581.0513">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.9863" x="906.4756" y="581.0513">Store Attester credential in the DB</text><polygon fill="#181818" points="1293.3418,624.25,1303.3418,628.25,1293.3418,632.25,1297.3418,628.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="877.3848" x2="1299.3418" y1="628.25" y2="628.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="884.3848" y="623.1841">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309.1436" x="906.4756" y="623.1841">Notify a Verifier to start RA on the new Attester</text><!--SRC=[ZLHHRzf037xFhx1uePLWbVQ8IgLqGnDZ30IClI15HsBWjd2NtHcw_llP5n98MRiXGOBlysT_dvsqILEEKJicGa_euBFL1WfdoQOsZzfeCYWXwa3M7FPhT56qjh-XDRGBcEQADjRjMr6X7EbK5yeGBARZnl_MOFmuYvU3bOctQAW5oeCw5KoKX2AkmwJDB6bbPUReZZh5aFI38ual0r7KxlVXIpo2rA4YRGtq-n6NlkyskNimmry73W1t2XVu4im_FVY41fqYvEEITqxSITECVz8FHacAZWJKVNW9gWwRyUx3fQGUJ2Vp1TofGj-vaZIHyvvqNHpM7RaQjSSEqu7GhGpyrsSu1PLb3htlG64TTU3xJXFccjl-DXj6nh9sfxSxxdw7zN20utgZqOCcpqQWHvFYku2Hna0QPnWV5DPa7fuqxK11kbDvZcRBK5aWOMTRGUN4NuVPSyZ6Z6EDcLxRDXan1dDVrejUmflkBLMkCvbYPJR0XJ3nWKS3cfVlG3kcrsa8tXpBF5aXkm4-gknbxQdmJKQtZAoblDr5BHxwKkzzCbO_yGEhbeegl-7cmYoDPIzbf8cCL0eqnTztN-6DWexhFGp5ufJqaNi-5wnSo75Jc_0t7F0amx03I5mehFUyCYTVkD72wQFiNhW9CCMUL7cSeqWIdq4v15uFlWyepmB3Mw5XuldnKwTcahHfKoXNwxujSwwN93XvvT_hprPgpKQx_KMrCyTRavsJPLtrg_ASVj8A7n-l69QbEQu7N-LPOckW2W5PyE4zCul1bWm6d-e2ilac-mC0]--></g></svg>