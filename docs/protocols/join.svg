<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="702px" preserveAspectRatio="none" style="width:1308px;height:702px;background:#FFFFFF;" version="1.1" viewBox="0 0 1308 702" width="1308px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="690.8438" style="stroke:#181818;stroke-width:0.5;" width="266" x="256" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="344" y="18.0669">IoT Platform</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="282" x2="282" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="477" x2="477" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="852" x2="852" y1="72.7266" y2="646.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1271.5" x2="1271.5" y1="72.7266" y2="646.25"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="260" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="267" y="61.4248">TPM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="260" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="267" y="665.2451">TPM</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="436" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="443" y="45.1279">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="456.5" y="61.4248">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="436" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="443" y="665.2451">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="456.5" y="681.542">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="820" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="840" y="45.1279">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="827" y="61.4248">Service</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="820" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="840" y="665.2451">Join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="827" y="681.542">Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="1241.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1248.5" y="61.4248">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="1241.5" y="645.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1248.5" y="665.2451">Verifier</text><polygon fill="#181818" points="293,99.8594,283,103.8594,293,107.8594,289,103.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="476" y1="103.8594" y2="103.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="98.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="312" y="98.7935">Request for AK creation</text><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="281" y1="132.9922" y2="132.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="240" y1="132.9922" y2="145.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="280" y1="145.9922" y2="145.9922"/><polygon fill="#181818" points="270,141.9922,280,145.9922,270,149.9922,274,145.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="181" y="127.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="194" y="127.9263">Generate AK</text><polygon fill="#181818" points="293,171.125,283,175.125,293,179.125,289,175.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="476" y1="175.125" y2="175.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="170.0591">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="312" y="170.0591">request EK_cert</text><polygon fill="#181818" points="465,200.2578,475,204.2578,465,208.2578,469,204.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="282" x2="471" y1="204.2578" y2="204.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="289" y="199.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="302" y="199.1919">EK_cert</text><polygon fill="#181818" points="840,247.5234,850,251.5234,840,255.5234,844,251.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="477" x2="846" y1="251.5234" y2="251.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="484" y="238.8911">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="497" y="231.3247">POST /api/request_join: AK pub, AK name, EK cert</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="649" y="246.4575">IP address, port, Whitelist URI</text><path d="M857,217.2578 L857,257.2578 L1144,257.2578 L1144,227.2578 L1134,217.2578 L857,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1134,217.2578 L1134,227.2578 L1144,227.2578 L1134,217.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="863" y="234.3247">The attester notifies its presence.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="863" y="249.4575">The join server responds with a challenge.</text><line style="stroke:#181818;stroke-width:1.0;" x1="852" x2="894" y1="287.7227" y2="287.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="894" y1="287.7227" y2="300.7227"/><line style="stroke:#181818;stroke-width:1.0;" x1="853" x2="894" y1="300.7227" y2="300.7227"/><polygon fill="#181818" points="863,296.7227,853,300.7227,863,304.7227,859,300.7227" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="859" y="282.6567">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="872" y="282.6567">validate EK_cert</text><path d="M986,267.5234 L986,307.5234 L1228,307.5234 L1228,277.5234 L1218,267.5234 L986,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1218,267.5234 L1218,277.5234 L1228,277.5234 L1218,267.5234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="992" y="284.5903">TPM is authentic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="992" y="299.7231">(validation of the EK certificate OK)</text><line style="stroke:#181818;stroke-width:1.0;" x1="852" x2="894" y1="333.9219" y2="333.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="894" y1="333.9219" y2="346.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="853" x2="894" y1="346.9219" y2="346.9219"/><polygon fill="#181818" points="863,342.9219,853,346.9219,863,350.9219,859,346.9219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="859" y="328.856">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="872" y="328.856">challenge = TPM2_MakeCredential(EK_pub, nonce, AK_name)</text><polygon fill="#181818" points="488,372.0547,478,376.0547,488,380.0547,484,376.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="851" y1="376.0547" y2="376.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="494" y="370.9888">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="507" y="370.9888">challenge</text><polygon fill="#181818" points="293,426.8867,283,430.8867,293,434.8867,289,430.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="287" x2="476" y1="430.8867" y2="430.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="425.8208">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="312" y="425.8208">TPM2_ActivateCredential</text><path d="M39,389.0547 L39,459.0547 L277,459.0547 L277,399.0547 L267,389.0547 L39,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M267,389.0547 L267,399.0547 L277,399.0547 L267,389.0547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="45" y="406.1216">tpm_activate credential verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="45" y="421.2544">the possession of AK_priv, EK_priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="45" y="436.3872">and verifies that they are in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="45" y="451.52">same TPM</text><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="281" y1="485.7188" y2="485.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="240" y1="485.7188" y2="498.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="240" x2="280" y1="498.7188" y2="498.7188"/><polygon fill="#181818" points="270,494.7188,280,498.7188,270,502.7188,274,498.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="7" y="480.6528">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="29" y="480.6528">activate_credential(EK_priv, challenge)</text><polygon fill="#181818" points="465,523.8516,475,527.8516,465,531.8516,469,527.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="282" x2="471" y1="527.8516" y2="527.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="289" y="522.7856">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="311" y="522.7856">nonce</text><polygon fill="#181818" points="840,552.9844,850,556.9844,840,560.9844,844,556.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="477" x2="846" y1="556.9844" y2="556.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="484" y="551.9185">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="506" y="551.9185">POST /api/confirm_credential: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="852" x2="894" y1="586.1172" y2="586.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="894" x2="894" y1="586.1172" y2="599.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="853" x2="894" y1="599.1172" y2="599.1172"/><polygon fill="#181818" points="863,595.1172,853,599.1172,863,603.1172,859,599.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="859" y="581.0513">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="881" y="581.0513">Store Attester credential in the DB</text><polygon fill="#181818" points="1260,624.25,1270,628.25,1260,632.25,1264,628.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="852" x2="1266" y1="628.25" y2="628.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="859" y="623.1841">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="881" y="623.1841">notify a Verifier to start RA on the new Attester</text><!--SRC=[ZLHTRnen47pthrZnGY918_KHXKYN5bMK8X0awGlIoTmjdDl3ljeBQVvzr_OTS454HU9hFJixExk-BYagKNGJ8dI45huRfQ6oXancIj55dKE4o3qPlT-jqGgnDd-XCpPFC2ybROpTTKGbBQbCLL8JFCsdhV-TqVHnaRoCLZhPegOEI0UoBfXA7n9SXqdRMLxAIY_H7bI68UaNHr8N0q9qXqFuaKmWioX96Gt3eU3Iz_qszm0M-6VF0M2bS8QFOFuOm3VKQ2KX7qVU9R6IjXbNwMrDFvga6LhoeFx3Ur1ps8xt7yvR6i1yjdo2ErcfkveqzUS3hxhQhtl-MyiTzfWEFDrAmt-zndEGUMxHkHvKnb8FVXQAi5Gi-tan5jfmxrPj2rPVu74um76rKUX0aMCZqA7Ey5F0U67WXJEC3ogZSmUlYWgGa1MoB55l6UeNoBEphI1BuhV5_2raOywnramlRPjD68EbY_N4UtZRlOCiLUwds9WDSDQOzu570ugNRqy5qwii16_gFBz2PWDyrDZBlMUURpQvPUInbOzL79k7eQ_tEPtAt_Y5k_OLPNd3ui8ijM4l_KXJFr9VeDtyVVyAhmXzNEvXA9Paf0wi-LImSQ74JJI1gbqgQvY_33KEU99Xs174BbJ6ELwPsXSMMbbryBiNVWIOP4-QFCwHv1FVG5e4NW_-7L2E6mnFXPQ9f-lNg4cpjasXtB7lsvXpkIJ1oGl_hj-jpEYDihkpQYUEZoQx9CDz7H-LPzR5Nk7humN3IpJ73k9TOckW2G4PSE4viqZ0H0QDhyS2VlDr_Wy0]--></g></svg>