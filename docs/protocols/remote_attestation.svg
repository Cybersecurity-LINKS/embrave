<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="871px" preserveAspectRatio="none" style="width:905px;height:871px;background:#FFFFFF;" version="1.1" viewBox="0 0 905 871" width="905px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="859.1094" style="stroke:#181818;stroke-width:0.5;" width="281" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="111.5" y="18.0669">IoT Platform</text><rect fill="none" height="623.5234" style="stroke:#000000;stroke-width:1.5;" width="782" x="10" y="89.7266"/><rect fill="none" height="132.5313" style="stroke:#000000;stroke-width:1.5;" width="353.5" x="428.5" y="573.7188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="252" x2="252" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="468.5" x2="468.5" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="726" x2="726" y1="72.7266" y2="814.5156"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="20" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="27" y="61.4248">TPM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="20" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="27" y="833.5107">TPM</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="211" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="218" y="45.1279">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="231.5" y="61.4248">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="211" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="218" y="833.5107">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="231.5" y="849.8076">Agent</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="438.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="445.5" y="61.4248">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="438.5" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="445.5" y="833.5107">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="680" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="687" y="61.4248">Join Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="680" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="687" y="833.5107">Join Service</text><path d="M10,89.7266 L87,89.7266 L87,96.8594 L77,106.8594 L10,106.8594 L10,89.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="623.5234" style="stroke:#000000;stroke-width:1.5;" width="782" x="10" y="89.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="102.7935">loop</text><polygon fill="#181818" points="263,123.9922,253,127.9922,263,131.9922,259,127.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="257" x2="468" y1="127.9922" y2="127.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="269" y="122.9263">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="282" y="122.9263">GET /api/quote: PCRs, nonce</text><polygon fill="#181818" points="53,153.125,43,157.125,53,161.125,49,157.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="47" x2="251" y1="157.125" y2="157.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="59" y="152.0591">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="72" y="152.0591">Load EK</text><polygon fill="#181818" points="240,182.2578,250,186.2578,240,190.2578,244,186.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="246" y1="186.2578" y2="186.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="49" y="181.1919">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="62" y="181.1919">(EK_handle, EK_pub)</text><polygon fill="#181818" points="53,211.3906,43,215.3906,53,219.3906,49,215.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="47" x2="251" y1="215.3906" y2="215.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="59" y="210.3247">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="72" y="210.3247">Load AK</text><polygon fill="#181818" points="240,240.5234,250,244.5234,240,248.5234,244,244.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="246" y1="244.5234" y2="244.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="49" y="239.4575">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="62" y="239.4575">(AK_handle, AK_pub)</text><polygon fill="#181818" points="53,269.6563,43,273.6563,53,277.6563,49,273.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="47" x2="251" y1="273.6563" y2="273.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="59" y="268.5903">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="72" y="268.5903">TPM2_Quote (PCRs, nonce)</text><polygon fill="#181818" points="240,298.7891,250,302.7891,240,306.7891,244,302.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="246" y1="302.7891" y2="302.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="49" y="297.7231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="62" y="297.7231">Quote</text><polygon fill="#181818" points="53,327.9219,43,331.9219,53,335.9219,49,331.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="47" x2="251" y1="331.9219" y2="331.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="59" y="326.856">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="72" y="326.856">Request quoted PCRs</text><polygon fill="#181818" points="240,357.0547,250,361.0547,240,365.0547,244,361.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="246" y1="361.0547" y2="361.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="49" y="355.9888">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="62" y="355.9888">Values of quoted PCRs</text><line style="stroke:#181818;stroke-width:1.0;" x1="210" x2="251" y1="390.1875" y2="390.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="210" x2="210" y1="390.1875" y2="403.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="210" x2="250" y1="403.1875" y2="403.1875"/><polygon fill="#181818" points="240,399.1875,250,403.1875,240,407.1875,244,403.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="130" y="385.1216">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="152" y="385.1216">Collect IMA log</text><polygon fill="#181818" points="457,428.3203,467,432.3203,457,436.3203,461,432.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="252" x2="463" y1="432.3203" y2="432.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="259" y="427.2544">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="281" y="427.2544">Quote, PCRs, IMA log</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="511" y1="461.4531" y2="461.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="511" x2="511" y1="461.4531" y2="474.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="470" x2="511" y1="474.4531" y2="474.4531"/><polygon fill="#181818" points="480,470.4531,470,474.4531,480,478.4531,476,474.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="456.3872">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="498" y="456.3872">Verfiy quote</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="511" y1="503.5859" y2="503.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="511" x2="511" y1="503.5859" y2="516.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="470" x2="511" y1="516.5859" y2="516.5859"/><polygon fill="#181818" points="480,512.5859,470,516.5859,480,520.5859,476,516.5859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="498.52">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="498" y="498.52">Verify IMA log integrity</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="511" y1="545.7188" y2="545.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="511" x2="511" y1="545.7188" y2="558.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="470" x2="511" y1="558.7188" y2="558.7188"/><polygon fill="#181818" points="480,554.7188,470,558.7188,480,562.7188,476,558.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="540.6528">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="498" y="540.6528">Veryfy IMA log against the whitelist</text><path d="M428.5,573.7188 L608.5,573.7188 L608.5,580.8516 L598.5,590.8516 L428.5,590.8516 L428.5,573.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.5313" style="stroke:#000000;stroke-width:1.5;" width="353.5" x="428.5" y="573.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="135" x="443.5" y="586.7856">if Verification fails</text><polygon fill="#181818" points="714,607.9844,724,611.9844,714,615.9844,718,611.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="720" y1="611.9844" y2="611.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="606.9185">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="498" y="606.9185">Notify the failure</text><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="511" y1="641.1172" y2="641.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="511" x2="511" y1="641.1172" y2="654.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="470" x2="511" y1="654.1172" y2="654.1172"/><polygon fill="#181818" points="480,650.1172,470,654.1172,480,658.1172,476,654.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="636.0513">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="498" y="636.0513">stop RA</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="428.5" x2="782" y1="663.1172" y2="663.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="469" x2="511" y1="685.25" y2="685.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="511" x2="511" y1="685.25" y2="698.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="470" x2="511" y1="698.25" y2="698.25"/><polygon fill="#181818" points="480,694.25,470,698.25,480,702.25,476,698.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="476" y="680.1841">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="498" y="680.1841">continue RA</text><line style="stroke:#181818;stroke-width:1.0;" x1="726" x2="768" y1="741.3828" y2="741.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="768" x2="768" y1="741.3828" y2="754.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="727" x2="768" y1="754.3828" y2="754.3828"/><polygon fill="#181818" points="737,750.3828,727,754.3828,737,758.3828,733,754.3828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="733" y="736.3169">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="755" y="736.3169">Store the failure event</text><line style="stroke:#181818;stroke-width:1.0;" x1="726" x2="768" y1="783.5156" y2="783.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="768" x2="768" y1="783.5156" y2="796.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="727" x2="768" y1="796.5156" y2="796.5156"/><polygon fill="#181818" points="737,792.5156,727,796.5156,737,800.5156,733,796.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="733" y="778.4497">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="755" y="778.4497">Notify the event</text><!--SRC=[VPDDYzj038Rlyoj4Bjc5X8KUGmcuYodRRKhg3JaLpCIM7PN9o3kMq-RVTpnE6dlpSR11uj6hTpIQiP0OLEC4Tom8aGZMeeNOGkLOE6EZncXpw3Yb6s7Rx3RebDhmNnYzy0gMHal1RZTIbNP26LNQ2goMYq4yYXTVacWT_x9HYLP6e6lGeH-wLBSfvHjvqM7L6XqLX2xm-sCmHBunMNX3jwSC0_RR9zAwIoXbc2jrgfpEXprdy3LUmPEkwEczyIEOmV8vgITWsVhQ8JkT-pFDu3lh7E9NvODBjOVuDTrgcnkSU2QjcitZ7PNebafqLedkgVZVf_HdQnmUUiOVhyi6yBfGWk-Dpq8OGXw6S5rZhOq7WOi1EgG-JpzMFRCnc0cyB28mN5vuE5tFqUFaU0id_7nxPz0lHa67piKjW8h3IGF82fQEv70BFlHWNMgoVXooHVYp9K53jQZISLC15PqqPTr3AJIPMi7_vOJfVB21C_Z1qZffnLguSVW1F_keXIj88eMclWrbR8LiWm6qUVZw7IyTl0axx1i0tBSlxdvLttZW_m40]--></g></svg>