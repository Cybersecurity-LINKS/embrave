<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="871px" preserveAspectRatio="none" style="width:922px;height:871px;background:#FFFFFF;" version="1.1" viewBox="0 0 922 871" width="922px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="859.1094" style="stroke:#181818;stroke-width:0.5;" width="283.8389" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.6763" x="112.5813" y="18.0669">IoT Platform</text><rect fill="none" height="623.5234" style="stroke:#000000;stroke-width:1.5;" width="797.6909" x="10" y="89.7266"/><rect fill="none" height="132.5313" style="stroke:#000000;stroke-width:1.5;" width="362.8794" x="434.8115" y="573.7188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="41" x2="41" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="254.582" x2="254.582" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="476.8115" x2="476.8115" y1="72.7266" y2="814.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="739.0425" x2="739.0425" y1="72.7266" y2="814.5156"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="20" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="27" y="61.4248">TPM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="20" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="27" y="833.5107">TPM</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.2568" x="213.582" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.2568" x="220.582" y="45.1279">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="233.9907" y="61.4248">Agent</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.2568" x="213.582" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.2568" x="220.582" y="833.5107">EMBRAVE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="233.9907" y="849.8076">Agent</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0234" x="444.8115" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0234" x="451.8115" y="61.4248">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0234" x="444.8115" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0234" x="451.8115" y="833.5107">Verifier</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.6484" x="692.0425" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.6484" x="699.0425" y="61.4248">Join Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.6484" x="692.0425" y="813.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.6484" x="699.0425" y="833.5107">Join Service</text><path d="M10,89.7266 L86.624,89.7266 L86.624,96.8594 L76.624,106.8594 L10,106.8594 L10,89.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="623.5234" style="stroke:#000000;stroke-width:1.5;" width="797.6909" x="10" y="89.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="25" y="102.7935">loop</text><polygon fill="#181818" points="265.7104,123.9922,255.7104,127.9922,265.7104,131.9922,261.7104,127.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="259.7104" x2="476.3232" y1="127.9922" y2="127.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="271.7104" y="122.9263">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5674" x="284.7559" y="122.9263">GET /api/quote: PCRs, nonce</text><polygon fill="#181818" points="52.5366,153.125,42.5366,157.125,52.5366,161.125,48.5366,157.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5366" x2="253.7104" y1="157.125" y2="157.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="58.5366" y="152.0591">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.2856" x="71.582" y="152.0591">Load EK</text><polygon fill="#181818" points="242.7104,182.2578,252.7104,186.2578,242.7104,190.2578,246.7104,186.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.5366" x2="248.7104" y1="186.2578" y2="186.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="48.5366" y="181.1919">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9355" x="61.582" y="181.1919">(EK_handle, EK_pub)</text><polygon fill="#181818" points="52.5366,211.3906,42.5366,215.3906,52.5366,219.3906,48.5366,215.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5366" x2="253.7104" y1="215.3906" y2="215.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="58.5366" y="210.3247">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.9648" x="71.582" y="210.3247">Load AK</text><polygon fill="#181818" points="242.7104,240.5234,252.7104,244.5234,242.7104,248.5234,246.7104,244.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.5366" x2="248.7104" y1="244.5234" y2="244.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="48.5366" y="239.4575">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.2939" x="61.582" y="239.4575">(AK_handle, AK_pub)</text><polygon fill="#181818" points="52.5366,269.6563,42.5366,273.6563,52.5366,277.6563,48.5366,273.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5366" x2="253.7104" y1="273.6563" y2="273.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="58.5366" y="268.5903">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.1284" x="71.582" y="268.5903">TPM2_Quote (PCRs, nonce)</text><polygon fill="#181818" points="242.7104,298.7891,252.7104,302.7891,242.7104,306.7891,246.7104,302.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.5366" x2="248.7104" y1="302.7891" y2="302.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="48.5366" y="297.7231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.5205" x="61.582" y="297.7231">Quote</text><polygon fill="#181818" points="52.5366,327.9219,42.5366,331.9219,52.5366,335.9219,48.5366,331.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5366" x2="253.7104" y1="331.9219" y2="331.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="58.5366" y="326.856">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.1689" x="71.582" y="326.856">Request quoted PCRs</text><polygon fill="#181818" points="242.7104,357.0547,252.7104,361.0547,242.7104,365.0547,246.7104,361.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.5366" x2="248.7104" y1="361.0547" y2="361.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="48.5366" y="355.9888">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9229" x="61.582" y="355.9888">Values of quoted PCRs</text><line style="stroke:#181818;stroke-width:1.0;" x1="212.7104" x2="253.7104" y1="390.1875" y2="390.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="212.7104" x2="212.7104" y1="390.1875" y2="403.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="212.7104" x2="252.7104" y1="403.1875" y2="403.1875"/><polygon fill="#181818" points="242.7104,399.1875,252.7104,403.1875,242.7104,407.1875,246.7104,403.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="129.0972" y="385.1216">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5225" x="151.188" y="385.1216">Collect IMA log</text><polygon fill="#181818" points="465.3232,428.3203,475.3232,432.3203,465.3232,436.3203,469.3232,432.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="254.7104" x2="471.3232" y1="432.3203" y2="432.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="261.7104" y="427.2544">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.665" x="283.8013" y="427.2544">Quote, PCRs, IMA log</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="519.3232" y1="461.4531" y2="461.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.3232" x2="519.3232" y1="461.4531" y2="474.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.3232" x2="519.3232" y1="474.4531" y2="474.4531"/><polygon fill="#181818" points="488.3232,470.4531,478.3232,474.4531,488.3232,478.4531,484.3232,474.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="456.3872">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.79" x="506.4141" y="456.3872">Verify quote</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="519.3232" y1="503.5859" y2="503.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.3232" x2="519.3232" y1="503.5859" y2="516.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.3232" x2="519.3232" y1="516.5859" y2="516.5859"/><polygon fill="#181818" points="488.3232,512.5859,478.3232,516.5859,488.3232,520.5859,484.3232,516.5859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="498.52">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.2207" x="506.4141" y="498.52">Verify IMA log integrity</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="519.3232" y1="545.7188" y2="545.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.3232" x2="519.3232" y1="545.7188" y2="558.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.3232" x2="519.3232" y1="558.7188" y2="558.7188"/><polygon fill="#181818" points="488.3232,554.7188,478.3232,558.7188,488.3232,562.7188,484.3232,558.7188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="540.6528">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.4526" x="506.4141" y="540.6528">Verify IMA log against the whitelist</text><path d="M434.8115,573.7188 L615.2451,573.7188 L615.2451,580.8516 L605.2451,590.8516 L434.8115,590.8516 L434.8115,573.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.5313" style="stroke:#000000;stroke-width:1.5;" width="362.8794" x="434.8115" y="573.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="135.4336" x="449.8115" y="586.7856">if Verification fails</text><polygon fill="#181818" points="727.8667,607.9844,737.8667,611.9844,727.8667,615.9844,731.8667,611.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="733.8667" y1="611.9844" y2="611.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="606.9185">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.605" x="506.4141" y="606.9185">Notify the failure</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="519.3232" y1="641.1172" y2="641.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.3232" x2="519.3232" y1="641.1172" y2="654.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.3232" x2="519.3232" y1="654.1172" y2="654.1172"/><polygon fill="#181818" points="488.3232,650.1172,478.3232,654.1172,488.3232,658.1172,484.3232,654.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="636.0513">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.6128" x="506.4141" y="636.0513">Stop RA</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="434.8115" x2="797.6909" y1="663.1172" y2="663.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="477.3232" x2="519.3232" y1="685.25" y2="685.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.3232" x2="519.3232" y1="685.25" y2="698.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.3232" x2="519.3232" y1="698.25" y2="698.25"/><polygon fill="#181818" points="488.3232,694.25,478.3232,698.25,488.3232,702.25,484.3232,698.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="484.3232" y="680.1841">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.5137" x="506.4141" y="680.1841">Continue RA</text><line style="stroke:#181818;stroke-width:1.0;" x1="739.8667" x2="781.8667" y1="741.3828" y2="741.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="781.8667" x2="781.8667" y1="741.3828" y2="754.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.8667" x2="781.8667" y1="754.3828" y2="754.3828"/><polygon fill="#181818" points="750.8667,750.3828,740.8667,754.3828,750.8667,758.3828,746.8667,754.3828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="746.8667" y="736.3169">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.7515" x="768.9575" y="736.3169">Store the failure event</text><line style="stroke:#181818;stroke-width:1.0;" x1="739.8667" x2="781.8667" y1="783.5156" y2="783.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="781.8667" x2="781.8667" y1="783.5156" y2="796.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.8667" x2="781.8667" y1="796.5156" y2="796.5156"/><polygon fill="#181818" points="750.8667,792.5156,740.8667,796.5156,750.8667,800.5156,746.8667,796.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="746.8667" y="778.4497">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2822" x="768.9575" y="778.4497">Notify the event</text><!--SRC=[ZPDHQ-904CVVzrCCljY2KkYZ749EGkcr7bugFXs4DPd4ETQTT3Fnhj_-DXkjfbhfGm8p_EO__vsT7Gg9GJLCSCk248bWBLg8BLIEXJCsQeWsXuvJkX6spNQDJgar_uF18ozXORGKxBO3LMadb56bhS1oCU_5WtZ-FObMyMyRbMXb0Be67VgXItMRKhwH5-rNhT1HGUW2lzi7VUG7auKNT3lAC61_V2AjkuHIXhbIXyhnjDzp0W_n4kvqHNUlZH_111Qpf1w1PUjh- -nuwiyqWMVMESHFoWVdQZVnKxhHDZSuyanQDUlRAohHPohHKIMwfk9_z-clrZZSd1Y_lImRmCj22RusFWjX27aOmcMDbJOU12vwQ9_wDlvODMDZC1Dud4TWk3ppSBYUlSVH_XOE-F7sZc1OZBVEnJLWhm5a1Kj7ylOLM9UQh1-7R13-RaZGK2sgTDnKG4L7KzOzb4AJgHMyBoUCfxqDdC1FbbQy5MlXnk47_EZZHRY2959ewi-X6LiXss00RHw-quxd3hoimrC3WBlsnLslEZKU-Fy0]--></g></svg>